id: vulnlab-cve-fingerprints

info:
  name: VulnLab â€“ CVE Fingerprint Headers & Endpoints
  author: vulnlab-edu
  severity: medium
  description: |
    Detects CVE fingerprint simulations in VulnLab:
    - X-Jenkins: 2.150 response header on all pages
    - Vulnerable plugin version disclosure on /wp-plugin
    - Log4Shell JNDI error on /log4j-test
    THIS IS A SIMULATED VULNERABILITY on an isolated training lab.
  tags: cve,jenkins,log4j,fingerprint,vulnlab

http:
  - method: GET
    path:
      - "{{BaseURL}}/"
      - "{{BaseURL}}/wp-plugin"
      - "{{BaseURL}}/log4j-test"

    matchers-condition: or
    matchers:
      - type: word
        part: header
        words:
          - "X-Jenkins: 2.150"

      - type: word
        part: body
        words:
          - "CVE-2022-XXXX"
          - "Vulnerable Plugin Version: 1.2.3"
        condition: or

      - type: word
        part: body
        words:
          - "JNDI lookup attempted"
          - "CVE-2021-44228"
        condition: or
